{"ast":null,"code":"// ./src/azure-cognitiveservices-computervision.js\n// Azure SDK client libraries\nconst async = require('async');\n\nconst fs = require('fs');\n\nconst https = require('https');\n\nconst path = require(\"path\");\n\nconst createReadStream = require('fs').createReadStream;\n\nconst sleep = require('util').promisify(setTimeout);\n\nconst regex = new RegExp(/((?:(http|https|Http|Https|rtsp|Rtsp):\\/\\/(?:(?:[a-zA-Z0-9\\$\\-\\_\\.\\+\\!\\*\\'\\(\\)\\,\\;\\?\\&\\=]|(?:\\%[a-fA-F0-9]{2})){1,64}(?:\\:(?:[a-zA-Z0-9\\$\\-\\_\\.\\+\\!\\*\\'\\(\\)\\,\\;\\?\\&\\=]|(?:\\%[a-fA-F0-9]{2})){1,25})?\\@)?)?((?:(?:[a-zA-Z0-9][a-zA-Z0-9\\-]{0,64}\\.)+(?:(?:aero|arpa|asia|a[cdefgilmnoqrstuwxz])|(?:biz|b[abdefghijmnorstvwyz])|(?:cat|com|coop|c[acdfghiklmnoruvxyz])|d[ejkmoz]|(?:edu|e[cegrstu])|f[ijkmor]|(?:gov|g[abdefghilmnpqrstuwy])|h[kmnrtu]|(?:info|int|i[delmnoqrst])|(?:jobs|j[emop])|k[eghimnrwyz]|l[abcikrstuvy]|(?:mil|mobi|museum|m[acdghklmnopqrstuvwxyz])|(?:name|net|n[acefgilopruz])|(?:org|om)|(?:pro|p[aefghklmnrstwy])|qa|r[eouw]|s[abcdeghijklmnortuvyz]|(?:tel|travel|t[cdfghjklmnoprtvwz])|u[agkmsyz]|v[aceginu]|w[fs]|y[etu]|z[amw]))|(?:(?:25[0-5]|2[0-4][0-9]|[0-1][0-9]{2}|[1-9][0-9]|[1-9])\\.(?:25[0-5]|2[0-4][0-9]|[0-1][0-9]{2}|[1-9][0-9]|[1-9]|0)\\.(?:25[0-5]|2[0-4][0-9]|[0-1][0-9]{2}|[1-9][0-9]|[1-9]|0)\\.(?:25[0-5]|2[0-4][0-9]|[0-1][0-9]{2}|[1-9][0-9]|[0-9])))(?:\\:\\d{1,5})?)(\\/(?:(?:[a-zA-Z0-9\\;\\/\\?\\:\\@\\&\\=\\#\\~\\-\\.\\+\\!\\*\\'\\(\\)\\,\\_])|(?:\\%[a-fA-F0-9]{2}))*)?(?:\\b|$)/);\n\nconst ComputerVisionClient = require('@azure/cognitiveservices-computervision').ComputerVisionClient;\n\nconst ApiKeyCredentials = require('@azure/ms-rest-js').ApiKeyCredentials; // List of sample images to use in demo\n\n\nimport RandomImageUrl from './DefaultImages'; // Authentication requirements\n\nconst key = '35074228b393450690d5c9a4ac95c12b';\nconst endpoint = 'https://fhlcomputervison.cognitiveservices.azure.com/';\nconsole.log(`key = ${key}`);\nconsole.log(`endpoint = ${endpoint}`); // Cognitive service features\n\nconst visualFeatures = [\"ImageType\", \"Faces\", \"Adult\", \"Categories\", \"Color\", \"Tags\", \"Description\", \"Objects\", \"Brands\"];\nexport const isConfigured = () => {\n  const result = key && endpoint && key.length > 0 && endpoint.length > 0 ? true : false;\n  console.log(`key = ${key}`);\n  console.log(`endpoint = ${endpoint}`);\n  console.log(`ComputerVision isConfigured = ${result}`);\n  return result;\n}; // Computer Vision detected Printed Text\n\nconst includesText = async tags => {\n  return tags.filter(el => {\n    return el.name.toLowerCase() === \"text\";\n  });\n}; // Computer Vision detected Handwriting\n\n\nconst includesHandwriting = async tags => {\n  return tags.filter(el => {\n    return el.name.toLowerCase() === \"handwriting\";\n  });\n}; // Wait for text detection to succeed\n\n\nconst wait = timeout => {\n  return new Promise(resolve => {\n    setTimeout(resolve, timeout);\n  });\n}; // Analyze Image from URL\n\n\nexport const computerVision = async url => {\n  async.series([async function () {\n    const printedTextSampleURL = 'https://moderatorsampleimages.blob.core.windows.net/samples/sample2.jpg';\n    const multiLingualTextURL = 'https://raw.githubusercontent.com/Azure-Samples/cognitive-services-sample-data-files/master/ComputerVision/Images/MultiLingual.png'; //const handwrittenTextURL = 'https://raw.githubusercontent.com/Azure-Samples/cognitive-services-sample-data-files/master/ComputerVision/Images/MultiPageHandwrittenForm.pdf'; \n\n    const handwrittenTextURL = 'https://raw.githubusercontent.com/Azure-Samples/cognitive-services-sample-data-files/master/ComputerVision/Images/handwritten_text.jpg';\n    const STATUS_SUCCEEDED = \"succeeded\";\n    const STATUS_FAILED = \"failed\";\n    const handwrittenImagePath = url;\n    console.log('\\Reading local image for text in ...', path.basename(handwrittenImagePath));\n    const streamResponse = await computerVisionClient.readInStream(() => createReadStream(handwrittenImagePath)).then(response => {\n      return response;\n    });\n    console.log(); // Get operation location from response, so you can get the operation ID.\n\n    const operationLocationLocal = streamResponse.operationLocation; // Get the operation ID at the end of the URL\n\n    const operationIdLocal = operationLocationLocal.substring(operationLocationLocal.lastIndexOf('/') + 1); // Wait for the read operation to finish, use the operationId to get the result.\n\n    while (true) {\n      const readOpResult = await computerVisionClient.getReadResult(operationIdLocal).then(result => {\n        return result;\n      });\n      console.log('Read status: ' + readOpResult.status);\n\n      if (readOpResult.status === STATUS_FAILED) {\n        console.log('The Read File operation has failed.');\n        break;\n      }\n\n      if (readOpResult.status === STATUS_SUCCEEDED) {\n        console.log('The Read File operation was a success.');\n        console.log();\n        console.log('Read File local image result:');\n\n        for (const textRecResult of readOpResult.analyzeResult.readResults) {\n          for (const line of textRecResult.lines) {\n            if (regex.test(line.text)) {\n              urlList.push(line.text);\n            } else {\n              nonUrlList.push(line.text);\n            }\n          }\n        }\n\n        console.log(\"Urls in the text\");\n        urlList.forEach(function (entry) {\n          console.log(entry);\n        });\n        console.log(\"\\n\");\n        console.log(\"Text in the images\");\n        nonUrlList.forEach(function (entry) {\n          console.log(entry);\n        });\n        break;\n      }\n\n      await sleep(1000);\n    }\n\n    console.log();\n  }, function () {\n    return new Promise(resolve => {\n      resolve();\n    });\n  }], err => {\n    throw err;\n  });\n}; // analyze text in image\n\nconst readTextFromURL = async (client, url) => {\n  var _result;\n\n  let result = await client.read(url);\n  let operationID = result.operationLocation.split('/').slice(-1)[0]; // Wait for read recognition to complete\n  // result.status is initially undefined, since it's the result of read\n\n  const start = Date.now();\n  console.log(`${start} -${(_result = result) === null || _result === void 0 ? void 0 : _result.status} `);\n\n  while (result.status !== \"succeeded\") {\n    var _result2;\n\n    await wait(500);\n    console.log(`${Date.now() - start} -${(_result2 = result) === null || _result2 === void 0 ? void 0 : _result2.status} `);\n    result = await client.getReadResult(operationID);\n  } // Return the first page of result. \n  // Replace[0] with the desired page if this is a multi-page file such as .pdf or.tiff.\n\n\n  return result.analyzeResult;\n};","map":{"version":3,"sources":["C:/Users/ankusin.FAREAST/source/repos/JavaScript_end_to_end_client_analyze_image_with_Cognitive_Services/src/azure-cognitiveservices-computervision.js"],"names":["async","require","fs","https","path","createReadStream","sleep","promisify","setTimeout","regex","RegExp","ComputerVisionClient","ApiKeyCredentials","RandomImageUrl","key","endpoint","console","log","visualFeatures","isConfigured","result","length","includesText","tags","filter","el","name","toLowerCase","includesHandwriting","wait","timeout","Promise","resolve","computerVision","url","series","printedTextSampleURL","multiLingualTextURL","handwrittenTextURL","STATUS_SUCCEEDED","STATUS_FAILED","handwrittenImagePath","basename","streamResponse","computerVisionClient","readInStream","then","response","operationLocationLocal","operationLocation","operationIdLocal","substring","lastIndexOf","readOpResult","getReadResult","status","textRecResult","analyzeResult","readResults","line","lines","test","text","urlList","push","nonUrlList","forEach","entry","err","readTextFromURL","client","read","operationID","split","slice","start","Date","now"],"mappings":"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","sourcesContent":["// ./src/azure-cognitiveservices-computervision.js\r\n\r\n// Azure SDK client libraries\r\nconst async = require('async');\r\nconst fs = require('fs');\r\nconst https = require('https');\r\nconst path = require(\"path\");\r\nconst createReadStream = require('fs').createReadStream;\r\nconst sleep = require('util').promisify(setTimeout);\r\nconst regex= new RegExp(/((?:(http|https|Http|Https|rtsp|Rtsp):\\/\\/(?:(?:[a-zA-Z0-9\\$\\-\\_\\.\\+\\!\\*\\'\\(\\)\\,\\;\\?\\&\\=]|(?:\\%[a-fA-F0-9]{2})){1,64}(?:\\:(?:[a-zA-Z0-9\\$\\-\\_\\.\\+\\!\\*\\'\\(\\)\\,\\;\\?\\&\\=]|(?:\\%[a-fA-F0-9]{2})){1,25})?\\@)?)?((?:(?:[a-zA-Z0-9][a-zA-Z0-9\\-]{0,64}\\.)+(?:(?:aero|arpa|asia|a[cdefgilmnoqrstuwxz])|(?:biz|b[abdefghijmnorstvwyz])|(?:cat|com|coop|c[acdfghiklmnoruvxyz])|d[ejkmoz]|(?:edu|e[cegrstu])|f[ijkmor]|(?:gov|g[abdefghilmnpqrstuwy])|h[kmnrtu]|(?:info|int|i[delmnoqrst])|(?:jobs|j[emop])|k[eghimnrwyz]|l[abcikrstuvy]|(?:mil|mobi|museum|m[acdghklmnopqrstuvwxyz])|(?:name|net|n[acefgilopruz])|(?:org|om)|(?:pro|p[aefghklmnrstwy])|qa|r[eouw]|s[abcdeghijklmnortuvyz]|(?:tel|travel|t[cdfghjklmnoprtvwz])|u[agkmsyz]|v[aceginu]|w[fs]|y[etu]|z[amw]))|(?:(?:25[0-5]|2[0-4][0-9]|[0-1][0-9]{2}|[1-9][0-9]|[1-9])\\.(?:25[0-5]|2[0-4][0-9]|[0-1][0-9]{2}|[1-9][0-9]|[1-9]|0)\\.(?:25[0-5]|2[0-4][0-9]|[0-1][0-9]{2}|[1-9][0-9]|[1-9]|0)\\.(?:25[0-5]|2[0-4][0-9]|[0-1][0-9]{2}|[1-9][0-9]|[0-9])))(?:\\:\\d{1,5})?)(\\/(?:(?:[a-zA-Z0-9\\;\\/\\?\\:\\@\\&\\=\\#\\~\\-\\.\\+\\!\\*\\'\\(\\)\\,\\_])|(?:\\%[a-fA-F0-9]{2}))*)?(?:\\b|$)/);\r\nconst ComputerVisionClient = require('@azure/cognitiveservices-computervision').ComputerVisionClient;\r\nconst ApiKeyCredentials = require('@azure/ms-rest-js').ApiKeyCredentials;\r\n\r\n\r\n// List of sample images to use in demo\r\nimport RandomImageUrl from './DefaultImages';\r\n\r\n// Authentication requirements\r\nconst key = '35074228b393450690d5c9a4ac95c12b';\r\nconst endpoint = 'https://fhlcomputervison.cognitiveservices.azure.com/';\r\n\r\nconsole.log(`key = ${key}`)\r\nconsole.log(`endpoint = ${endpoint}`)\r\n\r\n// Cognitive service features\r\nconst visualFeatures = [\r\n    \"ImageType\",\r\n    \"Faces\",\r\n    \"Adult\",\r\n    \"Categories\",\r\n    \"Color\",\r\n    \"Tags\",\r\n    \"Description\",\r\n    \"Objects\",\r\n    \"Brands\"\r\n];\r\n\r\nexport const isConfigured = () => {\r\n    const result = (key && endpoint && (key.length > 0) && (endpoint.length > 0)) ? true : false;\r\n    console.log(`key = ${key}`)\r\n    console.log(`endpoint = ${endpoint}`)\r\n    console.log(`ComputerVision isConfigured = ${result}`)\r\n    return result;\r\n}\r\n\r\n// Computer Vision detected Printed Text\r\nconst includesText = async (tags) => {\r\n    return tags.filter((el) => {\r\n        return el.name.toLowerCase() === \"text\";\r\n    });\r\n}\r\n// Computer Vision detected Handwriting\r\nconst includesHandwriting = async (tags) => {\r\n    return tags.filter((el) => {\r\n        return el.name.toLowerCase() === \"handwriting\";\r\n    });\r\n}\r\n// Wait for text detection to succeed\r\nconst wait = (timeout) => {\r\n    return new Promise(resolve => {\r\n        setTimeout(resolve, timeout);\r\n    });\r\n}\r\n\r\n// Analyze Image from URL\r\nexport const computerVision = async (url) => {\r\n    async.series([\r\n        async function () {\r\n      const printedTextSampleURL = 'https://moderatorsampleimages.blob.core.windows.net/samples/sample2.jpg';\r\n      const multiLingualTextURL = 'https://raw.githubusercontent.com/Azure-Samples/cognitive-services-sample-data-files/master/ComputerVision/Images/MultiLingual.png';\r\n      //const handwrittenTextURL = 'https://raw.githubusercontent.com/Azure-Samples/cognitive-services-sample-data-files/master/ComputerVision/Images/MultiPageHandwrittenForm.pdf'; \r\n      const handwrittenTextURL = 'https://raw.githubusercontent.com/Azure-Samples/cognitive-services-sample-data-files/master/ComputerVision/Images/handwritten_text.jpg';\r\n\r\n      const STATUS_SUCCEEDED = \"succeeded\";\r\n      const STATUS_FAILED = \"failed\";\r\n\r\n      const handwrittenImagePath = url;\r\n    console.log('\\Reading local image for text in ...', path.basename(handwrittenImagePath));\r\n    \r\n    const streamResponse = await computerVisionClient.readInStream(() => createReadStream(handwrittenImagePath))\r\n      .then((response) => {\r\n        return response;\r\n      });\r\n      console.log();\r\n      // Get operation location from response, so you can get the operation ID.\r\n      const operationLocationLocal = streamResponse.operationLocation\r\n      // Get the operation ID at the end of the URL\r\n      const operationIdLocal = operationLocationLocal.substring(operationLocationLocal.lastIndexOf('/') + 1);\r\n\r\n      // Wait for the read operation to finish, use the operationId to get the result.\r\n      while (true) {\r\n        const readOpResult = await computerVisionClient.getReadResult(operationIdLocal)\r\n          .then((result) => {\r\n            return result;\r\n          })\r\n        console.log('Read status: ' + readOpResult.status)\r\n        if (readOpResult.status === STATUS_FAILED) {\r\n          console.log('The Read File operation has failed.')\r\n          break;\r\n        }\r\n        if (readOpResult.status === STATUS_SUCCEEDED) {\r\n          console.log('The Read File operation was a success.');\r\n          console.log();\r\n          console.log('Read File local image result:');\r\n          for (const textRecResult of readOpResult.analyzeResult.readResults) {\r\n            for (const line of textRecResult.lines) {\r\n              if(regex.test(line.text))\r\n              {\r\n                  urlList.push(line.text);\r\n              }\r\n              else{\r\n                  nonUrlList.push(line.text);\r\n              }\r\n            }\r\n          }\r\n          console.log(\"Urls in the text\");\r\n          urlList.forEach(function(entry)\r\n          {\r\n              console.log(entry);\r\n          }\r\n          )\r\n          console.log(\"\\n\");\r\n          console.log(\"Text in the images\");\r\n          nonUrlList.forEach(function(entry)\r\n          {\r\n          console.log(entry);\r\n          }\r\n          )\r\n          break;\r\n        }\r\n        await sleep(1000);\r\n      }\r\n      console.log();\r\n  },\r\n      function () {\r\n        return new Promise((resolve) => {\r\n          resolve();\r\n        })\r\n      }\r\n    ], (err) => {\r\n      throw (err);\r\n    });\r\n}\r\n// analyze text in image\r\nconst readTextFromURL = async (client, url) => {\r\n    \r\n    let result = await client.read(url);\r\n    let operationID = result.operationLocation.split('/').slice(-1)[0];\r\n\r\n    // Wait for read recognition to complete\r\n    // result.status is initially undefined, since it's the result of read\r\n    const start = Date.now();\r\n    console.log(`${start} -${result?.status} `);\r\n    \r\n    while (result.status !== \"succeeded\") {\r\n        await wait(500);\r\n        console.log(`${Date.now() - start} -${result?.status} `);\r\n        result = await client.getReadResult(operationID);\r\n    }\r\n    \r\n    // Return the first page of result. \r\n    // Replace[0] with the desired page if this is a multi-page file such as .pdf or.tiff.\r\n    return result.analyzeResult; \r\n}"]},"metadata":{},"sourceType":"module"}